<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Examples • ggrecipes</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Examples">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ggrecipes</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/ggrecipes.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/Ignophi/ggrecipes/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Examples</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/Ignophi/ggrecipes/blob/main/vignettes/ggrecipes.Rmd" class="external-link"><code>vignettes/ggrecipes.Rmd</code></a></small>
      <div class="d-none name"><code>ggrecipes.Rmd</code></div>
    </div>

    
    
<p>This vignette provides a <strong>quick visual overview</strong> of
available functions. Use the sidebar to jump to sections of interest.
For complete parameter lists and the many available customization
options, <strong>refer to the individual function documentation</strong>
(<code>?function_name</code>).</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/Ignophi/ggrecipes" class="external-link">ggrecipes</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="general">General<a class="anchor" aria-label="anchor" href="#general"></a>
</h2>
<div class="section level3">
<h3 id="split-correlation-heatmap">Split-Correlation Heatmap<a class="anchor" aria-label="anchor" href="#split-correlation-heatmap"></a>
</h3>
<p>Standard correlation heatmaps are symmetric, displaying identical
information in both triangles. When comparing <strong>two
groups</strong>, <code><a href="../reference/gg_splitcorr.html">gg_splitcorr()</a></code> uses this redundancy by
displaying one group’s correlations in the upper triangle and the other
group’s in the lower triangle. The function requires a data frame with
<strong>numeric variables</strong> and <strong>a binary splitting
variable</strong>. It computes pairwise correlations for each group,
adjusts p-values for multiple testing within each, and labels only
statistically significant correlations with their values.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Compare correlations between V-shaped vs straight engines</span></span>
<span><span class="fu"><a href="../reference/gg_splitcorr.html">gg_splitcorr</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">mtcars</span>,</span>
<span>  split <span class="op">=</span> <span class="st">"vs"</span>,</span>
<span>  prefix <span class="op">=</span> <span class="st">"Engine Type: "</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="ggrecipes_files/figure-html/unnamed-chunk-2-1.png" class="r-plt" width="700"></p>
<p>Currently there are two styles to choose from, <strong>tile</strong>
(default) and <strong>point</strong>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Alternative style</span></span>
<span><span class="fu"><a href="../reference/gg_splitcorr.html">gg_splitcorr</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">mtcars</span>,</span>
<span>  split <span class="op">=</span> <span class="st">"vs"</span>,</span>
<span>  prefix <span class="op">=</span> <span class="st">"Engine Type: "</span>,</span>
<span>  style <span class="op">=</span> <span class="st">"point"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="ggrecipes_files/figure-html/unnamed-chunk-3-1.png" class="r-plt" width="700"></p>
<p>See <code><a href="../reference/gg_splitcorr.html">?gg_splitcorr</a></code> for correlation methods, p-value
adjustment options, color schemes, and style customization.</p>
</div>
<div class="section level3">
<h3 id="rank-shift-plots">Rank Shift Plots<a class="anchor" aria-label="anchor" href="#rank-shift-plots"></a>
</h3>
<p>A frequently encountered task is assessing how the ranking of a set
of samples changes across two conditions. <code><a href="../reference/gg_rankshift.html">gg_rankshift()</a></code>
creates a <strong>three-panel visualization</strong>: side panels
display <strong>ranked distributions</strong> for each condition, while
the center panel connects corresponding samples with lines colored by
<strong>rank change direction</strong>. The function requires data with
sample identifiers, a grouping variable containing exactly <strong>two
levels</strong>, and a numeric value for ranking. Ranks are calculated
using summary statistics (mean or median) controlled by
<code>stat_summary</code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Synthetic data - bacterial strain growth rates</span></span>
<span><span class="va">growth_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  strain <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Strain"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">13</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">6</span><span class="op">)</span>,</span>
<span>  condition <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Control"</span>, <span class="st">"Treated"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">3</span>, times <span class="op">=</span> <span class="fl">13</span><span class="op">)</span>,</span>
<span>  growth_rate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">39</span>, mean <span class="op">=</span> <span class="fl">0.85</span>, sd <span class="op">=</span> <span class="fl">0.12</span><span class="op">)</span>,  <span class="co"># Control</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">39</span>, mean <span class="op">=</span> <span class="fl">0.45</span>, sd <span class="op">=</span> <span class="fl">0.10</span><span class="op">)</span>   <span class="co"># Treated</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/gg_rankshift.html">gg_rankshift</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">growth_data</span>,</span>
<span>  id <span class="op">=</span> <span class="st">"strain"</span>,</span>
<span>  group <span class="op">=</span> <span class="st">"condition"</span>,</span>
<span>  value <span class="op">=</span> <span class="st">"growth_rate"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="ggrecipes_files/figure-html/unnamed-chunk-4-1.png" class="r-plt" width="700"></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Alternative style &amp; minor customizations</span></span>
<span><span class="fu"><a href="../reference/gg_rankshift.html">gg_rankshift</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">growth_data</span>,</span>
<span>  id <span class="op">=</span> <span class="st">"strain"</span>,</span>
<span>  group <span class="op">=</span> <span class="st">"condition"</span>,</span>
<span>  value <span class="op">=</span> <span class="st">"growth_rate"</span>,</span>
<span>  style <span class="op">=</span> <span class="st">"bar"</span>,</span>
<span>  fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#e41a1c"</span>, <span class="st">"#377eb8"</span><span class="op">)</span>,</span>
<span>  rank_change_colors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    increase <span class="op">=</span> <span class="st">"#1b9e77"</span>,</span>
<span>    decrease <span class="op">=</span> <span class="st">"#d95f02"</span>,</span>
<span>    no_change <span class="op">=</span> <span class="st">"#7570b3"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  panel_ratio <span class="op">=</span> <span class="fl">0.65</span>,</span>
<span>  point_size <span class="op">=</span> <span class="fl">2.5</span>,</span>
<span>  line_width <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  decreasing <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="ggrecipes_files/figure-html/unnamed-chunk-5-1.png" class="r-plt" width="700"></p>
<p>See <code><a href="../reference/gg_rankshift.html">?gg_rankshift</a></code> for options to customize colors,
adjust panel widths, and control point display.</p>
</div>
<div class="section level3">
<h3 id="confusioncontingency-tables">Confusion/Contingency Tables<a class="anchor" aria-label="anchor" href="#confusioncontingency-tables"></a>
</h3>
<p><code><a href="../reference/gg_conf.html">gg_conf()</a></code> creates bubble plots where bubble size
represents <strong>frequency counts</strong> for each unique combination
of <strong>two categorical variables</strong>. The function
automatically computes these counts from the raw data using
<code><a href="https://rdrr.io/r/base/table.html" class="external-link">table()</a></code>. Results can also be facetted when additional
categorical variables are supplied.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span></span>
<span><span class="va">mtcars</span><span class="op">$</span><span class="va">horsepower</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cut.html" class="external-link">cut</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">$</span><span class="va">hp</span>, breaks <span class="op">=</span> <span class="fl">5</span>, </span>
<span>         labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Very Low"</span>, <span class="st">"Low"</span>, <span class="st">"Medium"</span>, <span class="st">"High"</span>, <span class="st">"Very High"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">mtcars</span><span class="op">$</span><span class="va">`miles per gallon`</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cut.html" class="external-link">cut</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">$</span><span class="va">mpg</span>, breaks <span class="op">=</span> <span class="fl">5</span>,</span>
<span>         labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Very Low"</span>, <span class="st">"Low"</span>, <span class="st">"Medium"</span>, <span class="st">"High"</span>, <span class="st">"Very High"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/gg_conf.html">gg_conf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">mtcars</span>, x <span class="op">=</span> <span class="st">"horsepower"</span>, y <span class="op">=</span> <span class="st">"miles per gallon"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ggrecipes_files/figure-html/unnamed-chunk-6-1.png" class="r-plt" width="384"></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Custom styling</span></span>
<span><span class="fu"><a href="../reference/gg_conf.html">gg_conf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">mtcars</span>, x <span class="op">=</span> <span class="st">"horsepower"</span>, y <span class="op">=</span> <span class="st">"miles per gallon"</span>,</span>
<span>        fill <span class="op">=</span> <span class="st">"lightcoral"</span>, point_size_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">20</span><span class="op">)</span>,</span>
<span>        show_grid <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="ggrecipes_files/figure-html/unnamed-chunk-7-1.png" class="r-plt" width="384"></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># With faceting by "vs" column</span></span>
<span><span class="fu"><a href="../reference/gg_conf.html">gg_conf</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">mtcars</span>, x <span class="op">=</span> <span class="st">"horsepower"</span>, y <span class="op">=</span> <span class="st">"miles per gallon"</span>,</span>
<span>        fill <span class="op">=</span> <span class="st">"lightcoral"</span>, point_size_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">20</span><span class="op">)</span>,</span>
<span>        facet_x <span class="op">=</span> <span class="st">"vs"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ggrecipes_files/figure-html/unnamed-chunk-8-1.png" class="r-plt" width="700"></p>
<p>See <code><a href="../reference/gg_conf.html">?gg_conf</a></code> for customization of colors, sizes, grid
display, and faceting options.</p>
</div>
<div class="section level3">
<h3 id="criteria-heatmaps">Criteria Heatmaps<a class="anchor" aria-label="anchor" href="#criteria-heatmaps"></a>
</h3>
<p><code><a href="../reference/gg_criteria.html">gg_criteria()</a></code> displays samples against <strong>multiple
criteria</strong> as a heatmap. Optional <strong>barplots</strong> can
be added to show continuous metrics. As the vertical alignment between
heatmap and barplot panels depends on the exported figure dimensions,
the function provides <strong>recommended sizes</strong> based on the
number of candidates and criteria.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create example data</span></span>
<span><span class="co"># Example: Gene prioritization criteria</span></span>
<span><span class="va">gene_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  gene <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"BRCA1"</span>, <span class="st">"TP53"</span>, <span class="st">"EGFR"</span>, <span class="st">"KRAS"</span>, <span class="st">"MYC"</span>, </span>
<span>           <span class="st">"PTEN"</span>, <span class="st">"APC"</span>, <span class="st">"CDKN2A"</span>, <span class="st">"RB1"</span>, <span class="st">"VHL"</span><span class="op">)</span>,</span>
<span>  `Missense Variant_crit` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Yes"</span>, <span class="st">"Yes"</span>, <span class="st">"Yes"</span>, <span class="cn">NA</span>, <span class="st">"Yes"</span>, </span>
<span>                               <span class="st">"Yes"</span>, <span class="cn">NA</span>, <span class="st">"Yes"</span>, <span class="cn">NA</span>, <span class="st">"Yes"</span><span class="op">)</span>,</span>
<span>  `eQTL_crit` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Yes"</span>, <span class="st">"Yes"</span>, <span class="cn">NA</span>, <span class="st">"Yes"</span>, <span class="st">"Yes"</span>, </span>
<span>                  <span class="st">"Yes"</span>, <span class="st">"Yes"</span>, <span class="st">"Yes"</span>, <span class="st">"Yes"</span>, <span class="cn">NA</span><span class="op">)</span>,</span>
<span>  `pQTL_crit` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Yes"</span>, <span class="cn">NA</span>, <span class="st">"Yes"</span>, <span class="st">"Yes"</span>, <span class="cn">NA</span>, </span>
<span>                  <span class="st">"Yes"</span>, <span class="st">"Yes"</span>, <span class="cn">NA</span>, <span class="st">"Yes"</span>, <span class="st">"Yes"</span><span class="op">)</span>,</span>
<span>  `GWAS Hit_crit` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Yes"</span>, <span class="st">"Yes"</span>, <span class="st">"Yes"</span>, <span class="st">"Yes"</span>, <span class="cn">NA</span>, </span>
<span>                      <span class="st">"Yes"</span>, <span class="st">"Yes"</span>, <span class="st">"Yes"</span>, <span class="cn">NA</span>, <span class="cn">NA</span><span class="op">)</span>,</span>
<span>  `Loss of Function_crit` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="st">"Yes"</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="st">"Yes"</span>, </span>
<span>                              <span class="st">"Yes"</span>, <span class="st">"Yes"</span>, <span class="cn">NA</span>, <span class="st">"Yes"</span>, <span class="cn">NA</span><span class="op">)</span>,</span>
<span>  `High Conservation_crit` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Yes"</span>, <span class="st">"Yes"</span>, <span class="st">"Yes"</span>, <span class="st">"Yes"</span>, <span class="st">"Yes"</span>, </span>
<span>                               <span class="st">"Yes"</span>, <span class="st">"Yes"</span>, <span class="st">"Yes"</span>, <span class="st">"Yes"</span>, <span class="st">"Yes"</span><span class="op">)</span>,</span>
<span>  `mRNA DE_crit` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Yes"</span>, <span class="cn">NA</span>, <span class="st">"Yes"</span>, <span class="cn">NA</span>, <span class="cn">NA</span>,</span>
<span>                     <span class="st">"Yes"</span>, <span class="st">"Yes"</span>, <span class="st">"Yes"</span>, <span class="cn">NA</span>, <span class="st">"Yes"</span><span class="op">)</span>,</span>
<span>  `Prot DE_crit` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="st">"Yes"</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>,</span>
<span>                     <span class="st">"Yes"</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="st">"Yes"</span><span class="op">)</span>,</span>
<span>  check.names <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate total criteria met</span></span>
<span><span class="va">crit_cols</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"_crit$"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">gene_data</span><span class="op">)</span>, value <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">gene_data</span><span class="op">$</span><span class="va">`Total`</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/colSums.html" class="external-link">rowSums</a></span><span class="op">(</span><span class="va">gene_data</span><span class="op">[</span><span class="va">crit_cols</span><span class="op">]</span> <span class="op">==</span> <span class="st">"Yes"</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">gene_data</span><span class="op">)</span></span>
<span><span class="co">#&gt;    gene Missense Variant_crit eQTL_crit pQTL_crit GWAS Hit_crit</span></span>
<span><span class="co">#&gt; 1 BRCA1                   Yes       Yes       Yes           Yes</span></span>
<span><span class="co">#&gt; 2  TP53                   Yes       Yes      &lt;NA&gt;           Yes</span></span>
<span><span class="co">#&gt; 3  EGFR                   Yes      &lt;NA&gt;       Yes           Yes</span></span>
<span><span class="co">#&gt; 4  KRAS                  &lt;NA&gt;       Yes       Yes           Yes</span></span>
<span><span class="co">#&gt; 5   MYC                   Yes       Yes      &lt;NA&gt;          &lt;NA&gt;</span></span>
<span><span class="co">#&gt; 6  PTEN                   Yes       Yes       Yes           Yes</span></span>
<span><span class="co">#&gt;   Loss of Function_crit High Conservation_crit mRNA DE_crit Prot DE_crit Total</span></span>
<span><span class="co">#&gt; 1                  &lt;NA&gt;                    Yes          Yes         &lt;NA&gt;     6</span></span>
<span><span class="co">#&gt; 2                   Yes                    Yes         &lt;NA&gt;          Yes     6</span></span>
<span><span class="co">#&gt; 3                  &lt;NA&gt;                    Yes          Yes         &lt;NA&gt;     5</span></span>
<span><span class="co">#&gt; 4                  &lt;NA&gt;                    Yes         &lt;NA&gt;         &lt;NA&gt;     4</span></span>
<span><span class="co">#&gt; 5                   Yes                    Yes         &lt;NA&gt;         &lt;NA&gt;     4</span></span>
<span><span class="co">#&gt; 6                   Yes                    Yes          Yes          Yes     8</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Base criteria plot</span></span>
<span><span class="fu"><a href="../reference/gg_criteria.html">gg_criteria</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">gene_data</span>,</span>
<span>  id <span class="op">=</span> <span class="st">"gene"</span>,</span>
<span>  criteria <span class="op">=</span> <span class="st">"_crit$"</span>,</span>
<span>  show_text <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Recommended dimensions: 5.2 x 5.5 inches</span></span></code></pre></div>
<p><img src="ggrecipes_files/figure-html/unnamed-chunk-10-1.png" class="r-plt" width="700"></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># With added barplot</span></span>
<span><span class="fu"><a href="../reference/gg_criteria.html">gg_criteria</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">gene_data</span>,</span>
<span>  id <span class="op">=</span> <span class="st">"gene"</span>,</span>
<span>  criteria <span class="op">=</span> <span class="st">"_crit$"</span>,</span>
<span>  bar_column <span class="op">=</span> <span class="st">"Total"</span>,</span>
<span>  show_text <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  tile_fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>Yes <span class="op">=</span> <span class="st">"#A6CEE3"</span>, No <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span>,</span>
<span>  bar_fill <span class="op">=</span> <span class="st">"#A6CEE3"</span>,</span>
<span>  panel_ratio <span class="op">=</span> <span class="fl">0.7</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Recommended dimensions: 7.2 x 5.5 inches</span></span></code></pre></div>
<p><img src="ggrecipes_files/figure-html/unnamed-chunk-11-1.png" class="r-plt" width="657.6"></p>
<p>Criterion values can be displayed as text labels on tiles.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Example: VHH Variant Analysis</span></span>
<span><span class="co"># Define amino acid chemistry colors</span></span>
<span><span class="va">aa_colors</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"D"</span> <span class="op">=</span> <span class="st">"#E60A0A"</span>, <span class="st">"E"</span> <span class="op">=</span> <span class="st">"#E60A0A"</span>, <span class="co"># Acidic (red)</span></span>
<span>  <span class="st">"K"</span> <span class="op">=</span> <span class="st">"#145AFF"</span>, <span class="st">"R"</span> <span class="op">=</span> <span class="st">"#145AFF"</span>, <span class="co"># Basic (blue)</span></span>
<span>  <span class="st">"H"</span> <span class="op">=</span> <span class="st">"#8282D2"</span>,                  <span class="co"># Histidine (purple)</span></span>
<span>  <span class="st">"S"</span> <span class="op">=</span> <span class="st">"#FA9600"</span>, <span class="st">"T"</span> <span class="op">=</span> <span class="st">"#FA9600"</span>, <span class="co"># Polar uncharged (orange)</span></span>
<span>  <span class="st">"N"</span> <span class="op">=</span> <span class="st">"#00DCDC"</span>, <span class="st">"Q"</span> <span class="op">=</span> <span class="st">"#00DCDC"</span>, <span class="co"># Polar amides (cyan)</span></span>
<span>  <span class="st">"C"</span> <span class="op">=</span> <span class="st">"#E6E600"</span>,                  <span class="co"># Cysteine (yellow)</span></span>
<span>  <span class="st">"G"</span> <span class="op">=</span> <span class="st">"#EBEBEB"</span>,                  <span class="co"># Glycine (light gray)</span></span>
<span>  <span class="st">"P"</span> <span class="op">=</span> <span class="st">"#DC9682"</span>,                  <span class="co"># Proline (tan)</span></span>
<span>  <span class="st">"A"</span> <span class="op">=</span> <span class="st">"#C8C8C8"</span>,                  <span class="co"># Alanine (gray)</span></span>
<span>  <span class="st">"V"</span> <span class="op">=</span> <span class="st">"#0F820F"</span>, <span class="st">"I"</span> <span class="op">=</span> <span class="st">"#0F820F"</span>, <span class="co"># Hydrophobic (green)</span></span>
<span>  <span class="st">"L"</span> <span class="op">=</span> <span class="st">"#0F820F"</span>, <span class="st">"M"</span> <span class="op">=</span> <span class="st">"#0F820F"</span>,</span>
<span>  <span class="st">"F"</span> <span class="op">=</span> <span class="st">"#3232AA"</span>, <span class="st">"W"</span> <span class="op">=</span> <span class="st">"#B45AB4"</span>, <span class="co"># Aromatic (dark blue/purple)</span></span>
<span>  <span class="st">"Y"</span> <span class="op">=</span> <span class="st">"#3232AA"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">vhh_variants</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  variant <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"WT"</span>, <span class="st">"Mut1"</span>, <span class="st">"Mut2"</span>, <span class="st">"Mut3"</span>, <span class="st">"Mut4"</span>, <span class="st">"Mut7"</span>, <span class="st">"Mut5"</span>,</span>
<span>              <span class="st">"Mut6"</span>, <span class="st">"Mut8"</span>, <span class="st">"Mut9"</span>, <span class="st">"Mut10"</span>, <span class="st">"Mut11"</span><span class="op">)</span>,</span>
<span>  Q5_mut <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="st">"H"</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="st">"H"</span>, <span class="st">"H"</span>, <span class="st">"H"</span>, <span class="st">"D"</span>, <span class="cn">NA</span>, <span class="st">"H"</span><span class="op">)</span>,</span>
<span>  S55_mut <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="cn">NA</span>, <span class="st">"P"</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="st">"P"</span>, <span class="st">"P"</span>, <span class="cn">NA</span>, <span class="st">"P"</span>, <span class="st">"P"</span>, <span class="cn">NA</span>, <span class="cn">NA</span><span class="op">)</span>,</span>
<span>  N73_mut <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="st">"E"</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="st">"E"</span>, <span class="st">"E"</span>, <span class="cn">NA</span>, <span class="st">"E"</span>, <span class="cn">NA</span><span class="op">)</span>,</span>
<span>  K80_mut <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="st">"L"</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="st">"S"</span>, <span class="st">"V"</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="st">"L"</span>, <span class="st">"S"</span>, <span class="cn">NA</span><span class="op">)</span>,</span>
<span>  F99_mut <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="cn">NA</span>, <span class="st">"L"</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="st">"W"</span>, <span class="cn">NA</span>, <span class="st">"W"</span><span class="op">)</span>,</span>
<span>  KD_nM <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">45</span>, <span class="fl">18</span>, <span class="fl">5.2</span>, <span class="fl">38</span>, <span class="fl">42</span>, <span class="fl">20</span>, <span class="fl">3.8</span>, <span class="fl">15</span>, <span class="fl">3.2</span>, <span class="fl">4.5</span>, <span class="fl">40</span>, <span class="fl">22</span><span class="op">)</span>,</span>
<span>  yield_mg_L <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">12</span>, <span class="fl">11.8</span>, <span class="fl">10</span>, <span class="fl">13</span>, <span class="fl">11</span>, <span class="fl">10</span>, <span class="fl">10</span>, <span class="fl">12</span>, <span class="fl">10</span>, <span class="fl">7.8</span>, <span class="fl">12.5</span>, <span class="fl">8.5</span><span class="op">)</span>,</span>
<span>  Tm_C <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">68.5</span>, <span class="fl">67.8</span>, <span class="fl">68</span>, <span class="fl">72.3</span>, <span class="fl">35</span>, <span class="fl">66</span>, <span class="fl">67.5</span>, <span class="fl">70</span>, <span class="fl">70.5</span>, <span class="fl">72</span>, <span class="fl">38</span>, <span class="fl">74</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create plot</span></span>
<span><span class="fu"><a href="../reference/gg_criteria.html">gg_criteria</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">vhh_variants</span>,</span>
<span>  id <span class="op">=</span> <span class="st">"variant"</span>,</span>
<span>  criteria <span class="op">=</span> <span class="st">"_mut$"</span>,</span>
<span>  tile_fill <span class="op">=</span> <span class="va">aa_colors</span>,</span>
<span>  bar_column <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"KD_nM"</span>, <span class="st">"yield_mg_L"</span>, <span class="st">"Tm_C"</span><span class="op">)</span>,</span>
<span>  panel_ratio <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  tile_width <span class="op">=</span> <span class="fl">0.70</span>,</span>
<span>  tile_height <span class="op">=</span> <span class="fl">0.70</span>,</span>
<span>  show_text <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  border_color <span class="op">=</span> <span class="st">"grey40"</span>,</span>
<span>  border_width <span class="op">=</span> <span class="fl">0.4</span>,</span>
<span>  text_size <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  show_legend <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Recommended dimensions: 10.0 x 5.9 inches</span></span></code></pre></div>
<p><img src="ggrecipes_files/figure-html/unnamed-chunk-13-1.png" class="r-plt" width="700"></p>
<p>See <code><a href="../reference/gg_criteria.html">?gg_criteria</a></code> for tile customization, border styling,
and multi-barplot options.</p>
</div>
</div>
<div class="section level2">
<h2 id="bioinformatics">Bioinformatics<a class="anchor" aria-label="anchor" href="#bioinformatics"></a>
</h2>
<div class="section level3">
<h3 id="genotype-heatmaps">Genotype Heatmaps<a class="anchor" aria-label="anchor" href="#genotype-heatmaps"></a>
</h3>
<p>Genotype data typically consist of <strong>biallelic markers</strong>
such as SNPs, where each individual carries two alleles at each locus.
<code><a href="../reference/gg_geno.html">gg_geno()</a></code> provides a specialized visualization for these
data, <strong>sharing the core design and features</strong> of
<code><a href="../reference/gg_criteria.html">gg_criteria()</a></code> but adapted for diploid genotypes. Each tile
is split diagonally to represent both <strong>alleles</strong>
simultaneously, with samples occupying rows and genetic markers
occupying columns.</p>
<p>The function accepts data in wide format with genotype columns
identified by a regular expression pattern. Genotypes must be encoded as
“<code>allele1/allele2</code>” for unphased data or “allele1|allele2”
for phased data. The function automatically detects
<strong>phasing</strong> based on the separator and visually
distinguishes the two cases using border colors: black borders indicate
phased genotypes, while white borders indicate unphased genotypes. The
top-left triangle displays the first allele, and the bottom-right
triangle displays the second allele.</p>
<p>Like gg_criteria(), the function supports <strong>horizontal
barplots</strong> via <code>bar_column</code> to display continuous
variables alongside genotypes.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create example SNP and phenotype data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span></span>
<span><span class="va">snp_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"P"</span>, <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%03d"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">12</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="co"># SNP columns</span></span>
<span>  rs1234_geno <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"0/0"</span>, <span class="st">"0/1"</span>, <span class="st">"1/1"</span><span class="op">)</span>, <span class="cn">NA</span><span class="op">)</span>,</span>
<span>                       <span class="fl">12</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                       prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.4</span>, <span class="fl">0.4</span>, <span class="fl">0.15</span>, <span class="fl">0.05</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  rs5678_geno <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"0/0"</span>, <span class="st">"0/1"</span>, <span class="st">"0/2"</span>, <span class="st">"1/1"</span>, <span class="st">"1/2"</span>, <span class="st">"2/2"</span>, <span class="cn">NA</span><span class="op">)</span>,</span>
<span>                       <span class="fl">12</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                       prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.25</span>, <span class="fl">0.25</span>, <span class="fl">0.1</span>, <span class="fl">0.15</span>, <span class="fl">0.15</span>, <span class="fl">0.05</span>, <span class="fl">0.05</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  rs9012_geno <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"0|0"</span>, <span class="st">"0|1"</span>, <span class="st">"1|1"</span>, <span class="st">"0/1"</span>, <span class="st">"1/2"</span><span class="op">)</span>, <span class="cn">NA</span><span class="op">)</span>,</span>
<span>                       <span class="fl">12</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>,  </span>
<span>                       prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="fl">0.15</span>, <span class="fl">0.2</span>, <span class="fl">0.15</span>, <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  rs3456_geno <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"0/0"</span>, <span class="st">"0/1"</span>, <span class="st">"1/1"</span><span class="op">)</span>, <span class="cn">NA</span><span class="op">)</span>,</span>
<span>                       <span class="fl">12</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>,  </span>
<span>                       prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.45</span>, <span class="fl">0.35</span>, <span class="fl">0.15</span>, <span class="fl">0.05</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  rs7890_geno <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"0/0"</span>, <span class="st">"0/1"</span>, <span class="st">"0/2"</span>, <span class="st">"1/3"</span>, <span class="st">"2/2"</span>, <span class="cn">NA</span><span class="op">)</span>,</span>
<span>                       <span class="fl">12</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>,  </span>
<span>                       prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="fl">0.25</span>, <span class="fl">0.15</span>, <span class="fl">0.1</span>, <span class="fl">0.15</span>, <span class="fl">0.05</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  rs2468_geno <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"0|0"</span>, <span class="st">"0|1"</span>, <span class="st">"1|1"</span>, <span class="st">"1|2"</span>, <span class="cn">NA</span><span class="op">)</span>,</span>
<span>                       <span class="fl">12</span>, replace <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                       prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="fl">0.35</span>, <span class="fl">0.2</span>, <span class="fl">0.1</span>, <span class="fl">0.05</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  </span>
<span>  <span class="co"># Phenotype columns for bar plots</span></span>
<span>  Age <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">25</span><span class="op">:</span><span class="fl">75</span>, <span class="fl">12</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  BMI <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">12</span>, mean <span class="op">=</span> <span class="fl">26</span>, sd <span class="op">=</span> <span class="fl">4</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  Insulin <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">12</span>, mean <span class="op">=</span> <span class="fl">12</span>, sd <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">snp_data</span><span class="op">)</span></span>
<span><span class="co">#&gt;     id rs1234_geno rs5678_geno rs9012_geno rs3456_geno rs7890_geno rs2468_geno</span></span>
<span><span class="co">#&gt; 1 P001         0/0         1/2         1|1         0/1         0/0         1|1</span></span>
<span><span class="co">#&gt; 2 P002         0/1         1/1         1|1         0/0         1/3         0|1</span></span>
<span><span class="co">#&gt; 3 P003         0/1         0/1         0/1         0/0         0/0         0|0</span></span>
<span><span class="co">#&gt; 4 P004         1/1         0/2         0/1         0/0         0/1         0|1</span></span>
<span><span class="co">#&gt; 5 P005         1/1         0/1         0|1         0/0         2/2         1|1</span></span>
<span><span class="co">#&gt; 6 P006         0/0         0/1         0|0         0/0         0/0         0|0</span></span>
<span><span class="co">#&gt;   Age  BMI Insulin</span></span>
<span><span class="co">#&gt; 1  39 34.7    16.5</span></span>
<span><span class="co">#&gt; 2  65 30.8     7.4</span></span>
<span><span class="co">#&gt; 3  71 21.5    13.8</span></span>
<span><span class="co">#&gt; 4  50 24.4    12.4</span></span>
<span><span class="co">#&gt; 5  55 24.1    12.6</span></span>
<span><span class="co">#&gt; 6  40 29.1    13.1</span></span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Base genotype plot</span></span>
<span><span class="fu"><a href="../reference/gg_geno.html">gg_geno</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">snp_data</span>,</span>
<span>  id <span class="op">=</span> <span class="st">"id"</span>,</span>
<span>  geno <span class="op">=</span> <span class="st">"_geno$"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Recommended dimensions: 4.4 x 6.3 inches</span></span></code></pre></div>
<p><img src="ggrecipes_files/figure-html/unnamed-chunk-15-1.png" class="r-plt" width="700"></p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Show optional barplots</span></span>
<span><span class="fu"><a href="../reference/gg_geno.html">gg_geno</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">snp_data</span>,</span>
<span>  id <span class="op">=</span> <span class="st">"id"</span>,</span>
<span>  geno <span class="op">=</span> <span class="st">"_geno$"</span>,</span>
<span>  show_legend <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  panel_ratio <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  bar_column <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Age"</span>, <span class="st">"BMI"</span>, <span class="st">"Insulin"</span><span class="op">)</span>,</span>
<span>  bar_fill <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#c77d77"</span>, <span class="st">"#e0b46e"</span>, <span class="st">"#c7bc77"</span><span class="op">)</span>,</span>
<span>  text_size <span class="op">=</span> <span class="fl">10</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Recommended dimensions: 10.4 x 6.3 inches</span></span></code></pre></div>
<p><img src="ggrecipes_files/figure-html/unnamed-chunk-16-1.png" class="r-plt" width="672"></p>
<p>See <code><a href="../reference/gg_geno.html">?gg_geno</a></code> for allele color customization, tile
sizing, and barplot styling.</p>
</div>
<div class="section level3">
<h3 id="sequence-coverage">Sequence Coverage<a class="anchor" aria-label="anchor" href="#sequence-coverage"></a>
</h3>
<p><code><a href="../reference/gg_seq.html">gg_seq()</a></code> displays <strong>substrings</strong> of a
reference sequence, with each unique sequence shown as a row at its
aligned position. Useful for visualizing peptide mapping coverage, or
any analysis where you need to show which parts of a reference sequence
are covered by shorter sequences. Supports <strong>character
coloring</strong> and <strong>region highlighting</strong> (e.g. tags,
binding sites, CDRs).</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create synthetic example of peptide mapping data</span></span>
<span><span class="co"># Reference sequence</span></span>
<span><span class="va">ref_seq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span></span>
<span>  <span class="st">"QVQLVESGGGLVQAGGSLRLSCAASGFTFSSYAMGWFRQAPGKEREFVAAINSGGST"</span>,</span>
<span>  <span class="st">"YYPDSVKGRFTISRDNAKNTVYLQMNSLKPEDTAVYYCAADLRGTTVNNYWGQGTQV"</span>,</span>
<span>  <span class="st">"TVSSEQKLISEEDL"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Peptides with RT and intensity</span></span>
<span><span class="va">df_peptides</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Pep_1004"</span>, <span class="st">"Pep_1010"</span>, <span class="st">"Pep_1007"</span>, <span class="st">"Pep_1011"</span>, </span>
<span>         <span class="st">"Pep_1009"</span>, <span class="st">"Pep_1005"</span>, <span class="st">"Pep_1013"</span>, <span class="st">"Pep_1003"</span>, </span>
<span>         <span class="st">"Pep_1001"</span>, <span class="st">"Pep_1012"</span>, <span class="st">"Pep_1006"</span>, <span class="st">"Pep_1008"</span>, </span>
<span>         <span class="st">"Pep_1002"</span><span class="op">)</span>,</span>
<span>  sequence <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"QAPGKER"</span>,</span>
<span>    <span class="st">"GRFTISR"</span>,</span>
<span>    <span class="st">"GTTVNNYWGQGTQVTVSSEQKLISEEDL"</span>,</span>
<span>    <span class="st">"GRFTISRDNAKNTVYLQMNSLK"</span>,</span>
<span>    <span class="st">"EREFVAAINSGGSTYYPDSVK"</span>,</span>
<span>    <span class="st">"QAPGKEREFVAAINSGGSTYYPDSVKGR"</span>,</span>
<span>    <span class="st">"NTVYLQMNSLKPEDTAVYYCAADLR"</span>,</span>
<span>    <span class="st">"LSCAASGFTFSSYAMGWFRQAPGKER"</span>,</span>
<span>    <span class="st">"QVQLVESGGGLVQAGGSLR"</span>,</span>
<span>    <span class="st">"PEDTAVYYCAADLRGTTVNNYWGQGTQVTVSSEQKLISEEDL"</span>,</span>
<span>    <span class="st">"FTISRDNAKNTVYLQMNSLKPEDTAVYYCAADLR"</span>,</span>
<span>    <span class="st">"LSCAASGFTFSSYAMGWFRQAPGK"</span>,</span>
<span>    <span class="st">"LSCAASGFTFSSYAMGWFR"</span></span>
<span>  <span class="op">)</span>,</span>
<span>  rt_min <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">28.5</span>, <span class="fl">34.4</span>, <span class="fl">34.4</span>, <span class="fl">36</span>, <span class="fl">36.5</span>, <span class="fl">40.8</span>, </span>
<span>             <span class="fl">42.5</span>, <span class="fl">42.8</span>, <span class="fl">43.3</span>, <span class="fl">44.1</span>, <span class="fl">44.8</span>, <span class="fl">46.7</span><span class="op">)</span>,</span>
<span>  intensity <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2769840</span>, <span class="fl">2248170</span>, <span class="fl">2172370</span>, <span class="fl">1698280</span>, <span class="fl">2202810</span>, </span>
<span>                <span class="fl">983267</span>, <span class="fl">659246</span>, <span class="fl">1064906</span>, <span class="fl">1988932</span>, <span class="fl">1438544</span>, </span>
<span>                <span class="fl">639990</span>, <span class="fl">1017811</span>, <span class="fl">1112824</span><span class="op">)</span>,</span>
<span>  stringsAsFactors <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">df_peptides</span><span class="op">)</span></span>
<span><span class="co">#&gt;         id                     sequence rt_min intensity</span></span>
<span><span class="co">#&gt; 1 Pep_1004                      QAPGKER   10.0   2769840</span></span>
<span><span class="co">#&gt; 2 Pep_1010                      GRFTISR   28.5   2248170</span></span>
<span><span class="co">#&gt; 3 Pep_1007 GTTVNNYWGQGTQVTVSSEQKLISEEDL   34.4   2172370</span></span>
<span><span class="co">#&gt; 4 Pep_1011       GRFTISRDNAKNTVYLQMNSLK   34.4   1698280</span></span>
<span><span class="co">#&gt; 5 Pep_1009        EREFVAAINSGGSTYYPDSVK   36.0   2202810</span></span>
<span><span class="co">#&gt; 6 Pep_1005 QAPGKEREFVAAINSGGSTYYPDSVKGR   36.5    983267</span></span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Base coverage map</span></span>
<span><span class="fu"><a href="../reference/gg_seq.html">gg_seq</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">df_peptides</span>, ref <span class="op">=</span> <span class="va">ref_seq</span>, wrap <span class="op">=</span> <span class="fl">70</span><span class="op">)</span></span></code></pre></div>
<p><img src="ggrecipes_files/figure-html/unnamed-chunk-18-1.png" class="r-plt" width="700"></p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># With peptide IDs and residue coloring</span></span>
<span><span class="fu"><a href="../reference/gg_seq.html">gg_seq</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">df_peptides</span>, </span>
<span>  ref <span class="op">=</span> <span class="va">ref_seq</span>, </span>
<span>  name <span class="op">=</span> <span class="st">"id"</span>,</span>
<span>  color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>C <span class="op">=</span> <span class="st">"red"</span>, K <span class="op">=</span> <span class="st">"blue"</span>, R <span class="op">=</span> <span class="st">"#468c2d"</span><span class="op">)</span>, </span>
<span>  highlight <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"#ffb4b4"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">27</span><span class="op">:</span><span class="fl">33</span>, <span class="fl">51</span><span class="op">:</span><span class="fl">57</span>, <span class="fl">96</span><span class="op">:</span><span class="fl">107</span><span class="op">)</span>,</span>
<span>    <span class="st">"#70bcfa"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">43</span>, <span class="fl">64</span>, <span class="fl">75</span>, <span class="fl">86</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  wrap <span class="op">=</span> <span class="fl">70</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="ggrecipes_files/figure-html/unnamed-chunk-19-1.png" class="r-plt" width="700"></p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># With annotations</span></span>
<span><span class="fu"><a href="../reference/gg_seq.html">gg_seq</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">df_peptides</span>, </span>
<span>  ref <span class="op">=</span> <span class="va">ref_seq</span>, </span>
<span>  name <span class="op">=</span> <span class="st">"id"</span>,</span>
<span>  color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>C <span class="op">=</span> <span class="st">"red"</span>, K <span class="op">=</span> <span class="st">"blue"</span>, R <span class="op">=</span> <span class="st">"#468c2d"</span><span class="op">)</span>,</span>
<span>  highlight <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"#ffb4b4"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">27</span><span class="op">:</span><span class="fl">33</span>, <span class="fl">51</span><span class="op">:</span><span class="fl">57</span>, <span class="fl">96</span><span class="op">:</span><span class="fl">107</span><span class="op">)</span>,  <span class="co"># CDR regions</span></span>
<span>    <span class="st">"#70bcfa"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">43</span>, <span class="fl">64</span>, <span class="fl">75</span>, <span class="fl">86</span><span class="op">)</span>,     <span class="co"># Lysines</span></span>
<span>    <span class="st">"#d68718"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">105</span><span class="op">:</span><span class="fl">106</span><span class="op">)</span>,               <span class="co"># Liability site</span></span>
<span>    <span class="st">"#94d104"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">119</span><span class="op">:</span><span class="fl">128</span><span class="op">)</span>                <span class="co"># c-Myc tag</span></span>
<span>  <span class="op">)</span>,</span>
<span>  annotate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">"CDR1"</span>, pos <span class="op">=</span> <span class="fl">30</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">"CDR2"</span>, pos <span class="op">=</span> <span class="fl">54</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">"CDR3"</span>, pos <span class="op">=</span> <span class="fl">101</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">"N-term"</span>, pos <span class="op">=</span> <span class="fl">1</span>, angle <span class="op">=</span> <span class="fl">90</span>, vjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">"K43"</span>, pos <span class="op">=</span> <span class="fl">43</span>, angle <span class="op">=</span> <span class="fl">90</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">"K64"</span>, pos <span class="op">=</span> <span class="fl">64</span>, angle <span class="op">=</span> <span class="fl">90</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">"K75"</span>, pos <span class="op">=</span> <span class="fl">75</span>, angle <span class="op">=</span> <span class="fl">90</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">"K86"</span>, pos <span class="op">=</span> <span class="fl">86</span>, angle <span class="op">=</span> <span class="fl">90</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">"Liability"</span>, pos <span class="op">=</span> <span class="fl">106</span>, angle <span class="op">=</span> <span class="fl">90</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">"c-Myc tag"</span>, pos <span class="op">=</span> <span class="fl">124</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  annotate_defaults <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span>,</span>
<span>  wrap <span class="op">=</span> <span class="fl">80</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="ggrecipes_files/figure-html/unnamed-chunk-20-1.png" class="r-plt" width="700"></p>
<p>See <code><a href="../reference/gg_seq.html">?gg_seq</a></code> for residue coloring, region highlighting,
annotation options, and wrapping control.</p>
</div>
<div class="section level3">
<h3 id="sequence-differences">Sequence Differences<a class="anchor" aria-label="anchor" href="#sequence-differences"></a>
</h3>
<p>For sequence variant analysis, a common approach is displaying only
substituted positions to reduce visual noise (e.g., Jalview’s “Show
Differences from Reference” option or MSA viewers with consensus
masking). <code><a href="../reference/gg_seqdiff.html">gg_seqdiff()</a></code> displays <strong>only
positions</strong> that <strong>differ</strong> from the reference, with
matching positions hidden. Only substituted characters are displayed,
making mutations immediately visible. The function can also parse
<strong>Clustal alignment</strong> files directly using the
<code>clustal</code> argument. <code><a href="../reference/gg_seqdiff.html">gg_seqdiff()</a></code> supports the
same customization options as <code><a href="../reference/gg_seq.html">gg_seq()</a></code>.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># -----------------------------------------------------------------------</span></span>
<span><span class="co"># Example with Clustal alignment file</span></span>
<span><span class="co"># -----------------------------------------------------------------------</span></span>
<span><span class="co"># Create a temporary Clustal file</span></span>
<span><span class="va">clustal_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>fileext <span class="op">=</span> <span class="st">".aln"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/writeLines.html" class="external-link">writeLines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"CLUSTAL W (1.83) multiple sequence alignment"</span>,</span>
<span>  <span class="st">""</span>,</span>
<span>  <span class="st">"WT              EQKLISEEDLMKTAYIAKQRQISFVKSHFSRQLERIEKKIEAHFDDLHP"</span>,</span>
<span>  <span class="st">"Mutant1         EQKLISEEDLMKTAYIAKQRQISFVKSHFSRQLERIEKKIEAHFDDLHP"</span>,</span>
<span>  <span class="st">"Mutant2         EQKLISEEDLMKTAYIAKQRQRSFVKSHFSRQLERIEKKWEAHFDDLHP"</span>,</span>
<span>  <span class="st">"Mutant3         EQKLISEEDLMKTAYIAKQRQISFVKSHFSRQLER----IEAHFDDLHP"</span>,</span>
<span>  <span class="st">"Mutant4         EQKLISEEDLMKTAYIAKQRQISFVKSHFSRQAERIEKKIEAHFDDLHP"</span>,</span>
<span>  <span class="st">"Mutant5         EQKLISEEDLAKTAYIAKQRQISFVKSHFSRQLERIEKKIEAHFDDRHP"</span>,</span>
<span>  <span class="st">"Mutant6         EQKLISEEDLMKTAYIAKQRQISFVKSHFSRQLERIEKKIEAHFDDLHP"</span>,</span>
<span>  <span class="st">"                *********** ***************** * ******* *******:**"</span>,</span>
<span>  <span class="st">""</span>,</span>
<span>  <span class="st">"WT              DIVALSGHTFGKTHGAGKQSSHHHHHH"</span>,</span>
<span>  <span class="st">"Mutant1         DIVALSGHTFGKTHGAGKQSSHHHHHH"</span>,</span>
<span>  <span class="st">"Mutant2         DIVALSGHTFGKTHGAGKQSSHHHHHH"</span>,</span>
<span>  <span class="st">"Mutant3         DIVALSGHTFGKTHGAGKQSS------"</span>,</span>
<span>  <span class="st">"Mutant4         DIVALSGHTFGKTHGAGKQSSHHHHHH"</span>,</span>
<span>  <span class="st">"Mutant5         DIVALSGHTFGKTHGAGKQSSHHHHHH"</span>,</span>
<span>  <span class="st">"Mutant6         DRVALSGHTFAKTHGAGKQSS------"</span>,</span>
<span>  <span class="st">"                * ******** **********      "</span></span>
<span><span class="op">)</span>, <span class="va">clustal_file</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot Clustal alignment</span></span>
<span><span class="fu"><a href="../reference/gg_seqdiff.html">gg_seqdiff</a></span><span class="op">(</span></span>
<span>  clustal <span class="op">=</span> <span class="va">clustal_file</span>,</span>
<span>  ref <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"EQKLISEEDLMKTAYIAKQRQISFVKSHFSRQLERIEKKIEAHFDDLHP"</span>,</span>
<span>               <span class="st">"DIVALSGHTFGKTHGAGKQSSHHHHHH"</span><span class="op">)</span>,</span>
<span>  color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>K <span class="op">=</span> <span class="st">"#285bb8"</span>, R <span class="op">=</span> <span class="st">"#285bb8"</span>,    <span class="co"># Basic</span></span>
<span>            E <span class="op">=</span> <span class="st">"#a12b20"</span>, D <span class="op">=</span> <span class="st">"#a12b20"</span>,    <span class="co"># Acidic</span></span>
<span>            W <span class="op">=</span> <span class="st">"#9b59b6"</span>, F <span class="op">=</span> <span class="st">"#9b59b6"</span>,    <span class="co"># Aromatic</span></span>
<span>            H <span class="op">=</span> <span class="st">"#f39c12"</span><span class="op">)</span>,                  <span class="co"># Histidine</span></span>
<span>  highlight <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"#94d104"</span> <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span>,      <span class="co"># N-terminal c-Myc tag</span></span>
<span>    <span class="st">"#FFE0B2"</span> <span class="op">=</span> <span class="fl">30</span><span class="op">:</span><span class="fl">45</span>,     <span class="co"># Active site</span></span>
<span>    <span class="st">"#94d104"</span> <span class="op">=</span> <span class="fl">72</span><span class="op">:</span><span class="fl">77</span>      <span class="co"># C-terminal His-tag</span></span>
<span>  <span class="op">)</span>,</span>
<span>  annotate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">"c-Myc"</span>, pos <span class="op">=</span> <span class="fl">5</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">"Active site"</span>, pos <span class="op">=</span> <span class="fl">37</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">"6xHis"</span>, pos <span class="op">=</span> <span class="fl">74</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  wrap <span class="op">=</span> <span class="fl">60</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="ggrecipes_files/figure-html/unnamed-chunk-21-1.png" class="r-plt" width="700"></p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Clean up</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/unlink.html" class="external-link">unlink</a></span><span class="op">(</span><span class="va">clustal_file</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># -----------------------------------------------------------------------</span></span>
<span><span class="co"># Example with DNA sequences - gene structure with regulatory elements</span></span>
<span><span class="co"># -----------------------------------------------------------------------</span></span>
<span><span class="va">dna_ref</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span></span>
<span>  <span class="st">"TATAAA"</span>,                       <span class="co"># TATA box (promoter)</span></span>
<span>  <span class="st">"ATGCGATCGATCGATCGTAGCTAGCT"</span>,   <span class="co"># Exon 1</span></span>
<span>  <span class="st">"GTAAGTATCGATCGAT"</span>,             <span class="co"># Intron 1 (splice sites: GT...AG)</span></span>
<span>  <span class="st">"ACGTACGTACGTAGCTAGCTAGCTAC"</span>,   <span class="co"># Exon 2</span></span>
<span>  <span class="st">"GTACGTACGTACGTAC"</span>,             <span class="co"># Intron 2</span></span>
<span>  <span class="st">"GTACGTACGTAGCTAGCTAGCTACGT"</span>,   <span class="co"># Exon 3</span></span>
<span>  <span class="st">"ACGTACGTAAATAA"</span>                <span class="co"># 3'UTR with poly-A signal</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">dna_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  sequence <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="va">dna_ref</span>,                         </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"TATAAA"</span>, <span class="st">"TATATA"</span>, <span class="va">dna_ref</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"GTAAGT"</span>, <span class="st">"ATAAGT"</span>, <span class="va">dna_ref</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"CGATAG"</span>, <span class="st">"CGATAA"</span>, <span class="va">dna_ref</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"ATG"</span>, <span class="st">"AAG"</span>, <span class="va">dna_ref</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"AATAA$"</span>, <span class="st">"AACAA"</span>, <span class="va">dna_ref</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"GCGATCGATCGATCG"</span>, <span class="st">"GCGATCAATCGATCG"</span>, <span class="va">dna_ref</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"ACGTACGTACGTAG"</span>, <span class="st">"ACGTACATACGTAG"</span>, <span class="va">dna_ref</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"WT"</span>, <span class="st">"Promoter_mut"</span>, <span class="st">"Splice_donor"</span>,</span>
<span>         <span class="st">"Splice_acceptor"</span>, <span class="st">"Start_codon"</span>, <span class="st">"PolyA_mut"</span>,</span>
<span>         <span class="st">"Exon1_missense"</span>, <span class="st">"Exon2_frameshift"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Highlight gene structure elements</span></span>
<span><span class="fu"><a href="../reference/gg_seqdiff.html">gg_seqdiff</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">dna_df</span>, </span>
<span>  ref <span class="op">=</span> <span class="va">dna_ref</span>, </span>
<span>  name <span class="op">=</span> <span class="st">"id"</span>,</span>
<span>  color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>G <span class="op">=</span> <span class="st">"#4e8fb5"</span>, C <span class="op">=</span> <span class="st">"#845cab"</span><span class="op">)</span>,</span>
<span>  highlight <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="st">"#FFE0B2"</span> <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">6</span>,                     <span class="co"># TATA box (promoter)</span></span>
<span>    <span class="st">"#C8E6C9"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">7</span><span class="op">:</span><span class="fl">32</span>, <span class="fl">49</span><span class="op">:</span><span class="fl">74</span>, <span class="fl">91</span><span class="op">:</span><span class="fl">116</span><span class="op">)</span>,  <span class="co"># Exons</span></span>
<span>    <span class="st">"#FFCCBC"</span> <span class="op">=</span> <span class="fl">117</span><span class="op">:</span><span class="fl">130</span>                  <span class="co"># 3'UTR with poly-A</span></span>
<span>  <span class="op">)</span>,</span>
<span>  annotate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">"TATA"</span>, pos <span class="op">=</span> <span class="fl">1</span>, angle <span class="op">=</span> <span class="fl">90</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">"ATG"</span>, pos <span class="op">=</span> <span class="fl">7</span>, angle <span class="op">=</span> <span class="fl">90</span>, color <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">"Exon1"</span>, pos <span class="op">=</span> <span class="fl">19</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">"GT"</span>, pos <span class="op">=</span> <span class="fl">33</span>, angle <span class="op">=</span> <span class="fl">90</span>, size <span class="op">=</span> <span class="fl">2.5</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">"GA"</span>, pos <span class="op">=</span> <span class="fl">46</span>, angle <span class="op">=</span> <span class="fl">90</span>, size <span class="op">=</span> <span class="fl">2.5</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">"Exon2"</span>, pos <span class="op">=</span> <span class="fl">61</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">"GT"</span>, pos <span class="op">=</span> <span class="fl">75</span>, angle <span class="op">=</span> <span class="fl">90</span>, size <span class="op">=</span> <span class="fl">2.5</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">"AC"</span>, pos <span class="op">=</span> <span class="fl">89</span>, angle <span class="op">=</span> <span class="fl">90</span>, size <span class="op">=</span> <span class="fl">2.5</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">"Exon3"</span>, pos <span class="op">=</span> <span class="fl">103</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">"AATAAA"</span>, pos <span class="op">=</span> <span class="fl">125</span>, angle <span class="op">=</span> <span class="fl">90</span>, color <span class="op">=</span> <span class="st">"blue"</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  wrap <span class="op">=</span> <span class="fl">80</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="ggrecipes_files/figure-html/unnamed-chunk-22-1.png" class="r-plt" width="700"></p>
<p>See <code><a href="../reference/gg_seqdiff.html">?gg_seqdiff</a></code> for Clustal file support, residue
coloring, and annotation options.</p>
</div>
<div class="section level3">
<h3 id="biodistribution-plots">Biodistribution Plots<a class="anchor" aria-label="anchor" href="#biodistribution-plots"></a>
</h3>
<p><code><a href="../reference/gg_biodist.html">gg_biodist()</a></code> creates a barplot visualization of
biodistribution data (e.g., %ID/g across organs) with optional
<strong>separation</strong> of specific organs onto <strong>free
y-scales</strong> to prevent squishing of lower values. Points are
overlaid on bars and all facets are displayed in a single row.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bio_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  id        <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"sample_"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span>,</span>
<span>  condition <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Control"</span>, <span class="st">"Treated"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>,</span>
<span>  replicate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, times <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span></span>
<span>  Blood_val  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4.8</span>, <span class="fl">5.2</span>, <span class="fl">4.5</span>, <span class="fl">4.1</span>, <span class="fl">4.3</span>, <span class="fl">4.0</span><span class="op">)</span>,</span>
<span>  Heart_val  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.9</span>, <span class="fl">2.1</span>, <span class="fl">2.0</span>, <span class="fl">1.6</span>, <span class="fl">1.8</span>, <span class="fl">1.7</span><span class="op">)</span>,</span>
<span>  Lung_val   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3.5</span>, <span class="fl">3.8</span>, <span class="fl">3.2</span>, <span class="fl">3.0</span>, <span class="fl">3.1</span>, <span class="fl">2.9</span><span class="op">)</span>,</span>
<span>  Liver_val  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">14.2</span>, <span class="fl">15.1</span>, <span class="fl">13.8</span>, <span class="fl">11.5</span>, <span class="fl">12.0</span>, <span class="fl">11.2</span><span class="op">)</span>,</span>
<span>  Spleen_val <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">9.1</span>, <span class="fl">8.7</span>, <span class="fl">9.4</span>, <span class="fl">7.2</span>, <span class="fl">7.5</span>, <span class="fl">7.0</span><span class="op">)</span>,</span>
<span>  Kidney_val <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">125.0</span>, <span class="fl">112.8</span>, <span class="fl">121.9</span>, <span class="fl">111.1</span>, <span class="fl">102.4</span>, <span class="fl">103.0</span><span class="op">)</span>,</span>
<span>  Tumor_val  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">22.5</span>, <span class="fl">24.1</span>, <span class="fl">23.3</span>, <span class="fl">28.2</span>, <span class="fl">29.5</span>, <span class="fl">27.8</span><span class="op">)</span>,</span>
<span>  Muscle_val <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.7</span>, <span class="fl">0.6</span>, <span class="fl">0.8</span>, <span class="fl">0.5</span>, <span class="fl">0.4</span>, <span class="fl">0.6</span><span class="op">)</span>,</span>
<span>  Bone_val   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.4</span>, <span class="fl">1.6</span>, <span class="fl">1.5</span>, <span class="fl">1.1</span>, <span class="fl">1.2</span>, <span class="fl">1.0</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">bio_data</span><span class="op">)</span></span>
<span><span class="co">#&gt;         id condition replicate Blood_val Heart_val Lung_val Liver_val</span></span>
<span><span class="co">#&gt; 1 sample_1   Control         1       4.8       1.9      3.5      14.2</span></span>
<span><span class="co">#&gt; 2 sample_2   Control         2       5.2       2.1      3.8      15.1</span></span>
<span><span class="co">#&gt; 3 sample_3   Control         3       4.5       2.0      3.2      13.8</span></span>
<span><span class="co">#&gt; 4 sample_4   Treated         1       4.1       1.6      3.0      11.5</span></span>
<span><span class="co">#&gt; 5 sample_5   Treated         2       4.3       1.8      3.1      12.0</span></span>
<span><span class="co">#&gt; 6 sample_6   Treated         3       4.0       1.7      2.9      11.2</span></span>
<span><span class="co">#&gt;   Spleen_val Kidney_val Tumor_val Muscle_val Bone_val</span></span>
<span><span class="co">#&gt; 1        9.1      125.0      22.5        0.7      1.4</span></span>
<span><span class="co">#&gt; 2        8.7      112.8      24.1        0.6      1.6</span></span>
<span><span class="co">#&gt; 3        9.4      121.9      23.3        0.8      1.5</span></span>
<span><span class="co">#&gt; 4        7.2      111.1      28.2        0.5      1.1</span></span>
<span><span class="co">#&gt; 5        7.5      102.4      29.5        0.4      1.2</span></span>
<span><span class="co">#&gt; 6        7.0      103.0      27.8        0.6      1.0</span></span></code></pre></div>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Base biodist plot</span></span>
<span><span class="fu"><a href="../reference/gg_biodist.html">gg_biodist</a></span><span class="op">(</span><span class="va">bio_data</span>, id <span class="op">=</span> <span class="st">"organ"</span>,</span>
<span>           value <span class="op">=</span> <span class="st">"_val"</span>, group <span class="op">=</span> <span class="st">"condition"</span>,</span>
<span>           point_size <span class="op">=</span> <span class="fl">1.25</span>,</span>
<span>           y_label <span class="op">=</span> <span class="st">"%ID/g"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ggrecipes_files/figure-html/unnamed-chunk-24-1.png" class="r-plt" width="700"></p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Separate high uptake organs on separate axis</span></span>
<span><span class="fu"><a href="../reference/gg_biodist.html">gg_biodist</a></span><span class="op">(</span><span class="va">bio_data</span>, id <span class="op">=</span> <span class="st">"organ"</span>,</span>
<span>           value <span class="op">=</span> <span class="st">"_val"</span>, group <span class="op">=</span> <span class="st">"condition"</span>,</span>
<span>           point_size <span class="op">=</span> <span class="fl">1.25</span>,</span>
<span>           y_label <span class="op">=</span> <span class="st">"%ID/g"</span>,</span>
<span>           separate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Tumor"</span>, <span class="st">"Kidney"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="ggrecipes_files/figure-html/unnamed-chunk-25-1.png" class="r-plt" width="700"></p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Customization</span></span>
<span><span class="fu"><a href="../reference/gg_biodist.html">gg_biodist</a></span><span class="op">(</span><span class="va">bio_data</span>, id <span class="op">=</span> <span class="st">"organ"</span>,</span>
<span>           value <span class="op">=</span> <span class="st">"_val"</span>, group <span class="op">=</span> <span class="st">"condition"</span>,</span>
<span>           point_size <span class="op">=</span> <span class="fl">0</span>, error_bars <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>           fill_colors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#e41a1c"</span>, <span class="st">"#377eb8"</span><span class="op">)</span>,</span>
<span>           y_label <span class="op">=</span> <span class="st">"%ID/g"</span>,</span>
<span>           separate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Tumor"</span>, <span class="st">"Kidney"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="ggrecipes_files/figure-html/unnamed-chunk-26-1.png" class="r-plt" width="700"></p>
<p>See <code><a href="../reference/gg_biodist.html">?gg_biodist</a></code> for error bar options, summary statistic
choices, and color customization.</p>
</div>
</div>
<div class="section level2">
<h2 id="chemoinformatics">Chemoinformatics<a class="anchor" aria-label="anchor" href="#chemoinformatics"></a>
</h2>
<div class="section level3">
<h3 id="kinetic-rate-maps">Kinetic Rate Maps<a class="anchor" aria-label="anchor" href="#kinetic-rate-maps"></a>
</h3>
<p>Kinetic binding data from assays such as surface plasmon resonance
(SPR) or biolayer interferometry (BLI) are often summarized as
association (ka) and dissociation (kd) rate constants.
<code><a href="../reference/gg_kdmap.html">gg_kdmap()</a></code> displays these measurements on a <strong>log-log
plot</strong> with kd on the x-axis and ka on the y-axis.
<strong>Diagonal iso-affinity</strong> contours indicate constant
equilibrium dissociation constants (KD = kd/ka), so points along the
same line share the same affinity. The function requires a data frame
with columns for association rate (<code>ka</code>, in
<code>M⁻¹s⁻¹</code>), dissociation rate (<code>kd</code>, in
<code>s⁻¹</code>), and an identifier for grouping replicates.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Basic example: 5 variants with single measurements</span></span>
<span><span class="va">kinetic_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"WT"</span>, <span class="st">"Mut1"</span>, <span class="st">"Mut2"</span>, <span class="st">"Mut3"</span>, <span class="st">"Mut4"</span><span class="op">)</span>,</span>
<span>  ka <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.2e5</span>, <span class="fl">2.5e5</span>, <span class="fl">2e5</span>, <span class="fl">8.0e4</span>, <span class="fl">1.8e5</span><span class="op">)</span>,</span>
<span>  kd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.5e-3</span>, <span class="fl">2.0e-3</span>, <span class="fl">1.5e-3</span>, <span class="fl">1.2e-3</span>, <span class="fl">1.8e-3</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/gg_kdmap.html">gg_kdmap</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">kinetic_data</span>, show_anno <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; `geom_line()`: Each group consists of only one observation.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Do you need to adjust the <span style="color: #00BB00;">group</span> aesthetic?</span></span></code></pre></div>
<p><img src="ggrecipes_files/figure-html/unnamed-chunk-27-1.png" class="r-plt" width="700"></p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># With replicates: lines connect points with same ID</span></span>
<span><span class="va">kinetic_rep</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"WT"</span>, <span class="st">"WT"</span>, <span class="st">"WT"</span>, <span class="st">"Mut1"</span>, <span class="st">"Mut1"</span>, <span class="st">"Mut2"</span>, <span class="st">"Mut3"</span>, <span class="st">"Mut4"</span><span class="op">)</span>,</span>
<span>  ka <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.2e5</span>, <span class="fl">1.5e5</span>, <span class="fl">1.1e5</span>, <span class="fl">2.5e5</span>, <span class="fl">2.4e5</span>, <span class="fl">2e5</span>, <span class="fl">8.0e4</span>, <span class="fl">1.8e5</span><span class="op">)</span>,</span>
<span>  kd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.5e-3</span>, <span class="fl">1.6e-3</span>, <span class="fl">1.4e-3</span>, <span class="fl">2.0e-3</span>, <span class="fl">1.9e-3</span>, <span class="fl">1.5e-3</span>, <span class="fl">1.2e-3</span>, <span class="fl">1.8e-3</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">kinetic_rep</span><span class="op">)</span></span>
<span><span class="co">#&gt;     id     ka     kd</span></span>
<span><span class="co">#&gt; 1   WT 120000 0.0015</span></span>
<span><span class="co">#&gt; 2   WT 150000 0.0016</span></span>
<span><span class="co">#&gt; 3   WT 110000 0.0014</span></span>
<span><span class="co">#&gt; 4 Mut1 250000 0.0020</span></span>
<span><span class="co">#&gt; 5 Mut1 240000 0.0019</span></span>
<span><span class="co">#&gt; 6 Mut2 200000 0.0015</span></span>
<span></span>
<span><span class="fu"><a href="../reference/gg_kdmap.html">gg_kdmap</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">kinetic_rep</span>, show_anno <span class="op">=</span> <span class="cn">TRUE</span>, fill <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ggrecipes_files/figure-html/unnamed-chunk-28-1.png" class="r-plt" width="700"></p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Add labels and highlight reference</span></span>
<span><span class="fu"><a href="../reference/gg_kdmap.html">gg_kdmap</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">kinetic_rep</span>, show_anno <span class="op">=</span> <span class="cn">TRUE</span>, fill <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ggrecipes_files/figure-html/unnamed-chunk-28-2.png" class="r-plt" width="700"></p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Customize iso-KD lines</span></span>
<span><span class="fu"><a href="../reference/gg_kdmap.html">gg_kdmap</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">kinetic_rep</span>, show_anno <span class="op">=</span> <span class="cn">TRUE</span>, fill <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ggrecipes_files/figure-html/unnamed-chunk-28-3.png" class="r-plt" width="700"></p>
<p>See <code><a href="../reference/gg_kdmap.html">?gg_kdmap</a></code> for replicate line options, reference
highlighting, label placement, and iso-KD line customization.</p>
</div>
</div>
<div class="section level2">
<h2 id="further-customization">Further Customization<a class="anchor" aria-label="anchor" href="#further-customization"></a>
</h2>
<p>All functions return <code>ggplot2</code> objects that can be further
modified using standard ggplot2 syntax (see
<code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot2::ggplot()</a></code> and related documentation). Below is a
brief illustration using one of the functions; the same approach applies
to all other functions in this package.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gg_splitcorr.html">gg_splitcorr</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">mtcars</span>, split <span class="op">=</span> <span class="st">"vs"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Adjust legend</span></span>
<span><span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">"bottom"</span><span class="op">)</span></span></code></pre></div>
<p><img src="ggrecipes_files/figure-html/unnamed-chunk-29-1.png" class="r-plt" width="700"></p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Theme adjustments</span></span>
<span><span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">90</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="ggrecipes_files/figure-html/unnamed-chunk-30-1.png" class="r-plt" width="700"></p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Labels</span></span>
<span><span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Correlation comparison"</span>, </span>
<span>         caption <span class="op">=</span> <span class="st">"Data: mtcars"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>vjust <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="ggrecipes_files/figure-html/unnamed-chunk-31-1.png" class="r-plt" width="700"></p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Coordinate transformations</span></span>
<span><span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html" class="external-link">coord_fixed</a></span><span class="op">(</span>ratio <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span></span>
<span><span class="co">#&gt; Coordinate system already present.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Adding new coordinate system, which will replace the existing one.</span></span></code></pre></div>
<p><img src="ggrecipes_files/figure-html/unnamed-chunk-32-1.png" class="r-plt" width="700"></p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Font adjustments</span></span>
<span><span class="va">p</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>text <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>family <span class="op">=</span> <span class="st">"serif"</span>, size <span class="op">=</span> <span class="fl">14</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="ggrecipes_files/figure-html/unnamed-chunk-33-1.png" class="r-plt" width="700"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Ignophi Hu.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
